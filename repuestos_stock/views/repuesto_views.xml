<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- Vista heredada del formulario de productos (product.template) -->
    <record id="view_product_template_form_repuesto" model="ir.ui.view">
        <field name="name">product.template.form.repuesto</field>
        <field name="model">product.template</field>

        <!-- Se hereda la vista principal de productos -->
        <field name="inherit_id" ref="product.product_template_form_view"/>

        <field name="arch" type="xml">
            <!-- Insertamos contenido dentro del notebook (pestañas del formulario) -->
            <xpath expr="//sheet/notebook" position="inside">

                <!-- Pestaña principal "Repuesto" con campos generales -->
                <page string="Repuesto">
                    <group>
                        <!-- Tipo de repuesto: define si es inyector, sensor, etc. -->
                        <field name="tipo_repuesto"/>
                        <!-- Código interno del repuesto -->
                        <field name="codigo_repuesto"/>
                        <!-- Código original del fabricante (OEM) -->
                        <field name="codigo_oem"/>
                        <!-- Marca del repuesto -->
                        <field name="marca_id"/>
                        <!-- Relación con vehículos compatibles -->
                        <field name="vehiculo_ids" widget="many2many_tags"/>
                    </group>
                </page>

                <!-- Pestaña "Datos Inyector", solo visible si tipo_repuesto es 'inyector' -->
                <page string="Datos Inyector" t-if="object.tipo_repuesto == 'inyector'">
                    <group>
                        <!-- Color del aislante del inyector -->
                        <field name="insulating_color"/>
                        <!-- Tipo de inyección del inyector -->
                        <field name="injection_type"/>
                    </group>
                </page>

                <!-- Pestaña "Datos Pastillas de Freno", solo visible si tipo_repuesto es 'pastillas_freno' -->
                <page string="Datos Pastillas de Freno" t-if="object.tipo_repuesto == 'pastillas_freno'">
                    <group>
                        <!-- Material de la pastilla de freno -->
                        <field name="material"/>
                        <!-- Espesor de la pastilla -->
                        <field name="espesor"/>
                    </group>
                </page>

            </xpath>
        </field>
    </record>

    <!-- Acción para acceder al listado de repuestos desde el menú -->
    <record id="action_repuestos" model="ir.actions.act_window">
        <field name="name">Repuestos</field>
        <field name="res_model">product.template</field>
        <field name="view_mode">tree,form</field>
        <!-- Filtro: solo mostrar productos que tengan definido tipo_repuesto -->
        <field name="domain">[('tipo_repuesto', '!=', False)]</field>
    </record>

    <!-- Entrada de menú para acceder a la acción anterior -->
    <menuitem id="menu_repuestos" name="Repuestos" parent="base.menu_custom" action="action_repuestos"/>

</odoo>
